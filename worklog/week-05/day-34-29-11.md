# Worklog - NgÃ y 29/11/2025

## ğŸ“… ThÃ´ng tin cÆ¡ báº£n
- **NgÃ y**: 29/11/2025
- **Thá»©**: Thá»© Báº£y
- **Tuáº§n thá»±c táº­p**: 5/8
- **Thá»i gian lÃ m viá»‡c**: 18:00 - 22:00
- **Mood**: ğŸ‘ Táº­p trung vÃ o viá»‡c xÃ¢y dá»±ng tÃ­nh nÄƒng quáº£n lÃ½ ngÆ°á»i theo dÃµi.

## ğŸ¯ Má»¥c tiÃªu ngÃ y hÃ´m nay
- [x] PhÃ¡t triá»ƒn API cho Page Follower management (follow/unfollow má»™t page).
- [x] Thiáº¿t káº¿ database schema cho `page_followers` table.
- [x] Implement follow/unfollow functionality.

## ğŸ’¼ CÃ´ng viá»‡c Ä‘Ã£ thá»±c hiá»‡n

### 1. Thiáº¿t káº¿ database schema cho `page_followers` table â±ï¸ 1 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ thiáº¿t káº¿ báº£ng `page_followers` Ä‘á»ƒ lÆ°u trá»¯ má»‘i quan há»‡ giá»¯a Page vÃ  User theo dÃµi. TÆ°Æ¡ng tá»± nhÆ° `page_members`, báº£ng nÃ y sáº½ cÃ³ `page_id` vÃ  `user_id` lÃ m khÃ³a chÃ­nh phá»©c há»£p. ThÃªm cÃ¡c trÆ°á»ng nhÆ° `follow_date`.
- **Káº¿t quáº£**: Schema database cho `PageFollower` Ä‘Ã£ sáºµn sÃ ng.
- **Tools/Tech**: PostgreSQL, JPA.
- **Links**: [Code commit - `PageFollower` Entity (Cáº§n thÃªm áº£nh/link)], [Screenshot DBeaver/pgAdmin - `page_followers` table (Cáº§n thÃªm áº£nh/link)]

### 2. PhÃ¡t triá»ƒn API cho Page Follower management â±ï¸ 2 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ implement cÃ¡c endpoint RESTful API cho viá»‡c quáº£n lÃ½ ngÆ°á»i theo dÃµi cá»§a má»™t Page:
    - `POST /api/v1/pages/{slug}/followers`: NgÆ°á»i dÃ¹ng follow má»™t Page.
    - `DELETE /api/v1/pages/{slug}/followers/{userId}`: NgÆ°á»i dÃ¹ng unfollow má»™t Page.
    - `GET /api/v1/pages/{slug}/followers/count`: Láº¥y sá»‘ lÆ°á»£ng ngÆ°á»i theo dÃµi cá»§a Page.
    ÄÃ£ xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p cáº¡nh nhÆ° Page khÃ´ng tá»“n táº¡i, ngÆ°á»i dÃ¹ng Ä‘Ã£/chÆ°a follow.
- **Káº¿t quáº£**: Page Service cÃ³ thá»ƒ quáº£n lÃ½ ngÆ°á»i theo dÃµi cho tá»«ng Page.
- **Tools/Tech**: Spring Boot, Spring Data JPA, Postman.
- **Links**: [Code commit - Page Follower APIs (Cáº§n thÃªm áº£nh/link)], [Screenshot Postman tests - Page Follower APIs (Cáº§n thÃªm áº£nh/link)]

### 3. Implement follow/unfollow functionality â±ï¸ 1 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ táº¡o `PageFollower` Entity, Repository vÃ  Service layer. Logic follow/unfollow Ä‘Ã£ Ä‘Æ°á»£c tÃ­ch há»£p, bao gá»“m viá»‡c táº¡o hoáº·c xÃ³a má»‘i quan há»‡ trong báº£ng `page_followers`.
- **Káº¿t quáº£**: CÃ¡c chá»©c nÄƒng follow/unfollow hoáº¡t Ä‘á»™ng Ä‘Ãºng.
- **Tools/Tech**: Spring Data JPA, PostgreSQL.
- **Links**: [Code commit - `PageFollower` Service Logic (Cáº§n thÃªm áº£nh/link)]

## ğŸ“š Kiáº¿n thá»©c há»c Ä‘Æ°á»£c

### ğŸ”§ Ká»¹ nÄƒng ká»¹ thuáº­t
- **Database Relationships**: Cá»§ng cá»‘ ká»¹ nÄƒng thiáº¿t káº¿ vÃ  triá»ƒn khai má»‘i quan há»‡ nhiá»u-nhiá»u.
- **Concurrency Handling (Basic)**: Xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p ngÆ°á»i dÃ¹ng follow/unfollow Ä‘á»“ng thá»i.
- **API Design for Social Features**: Thiáº¿t káº¿ API cho cÃ¡c tÃ­nh nÄƒng xÃ£ há»™i cÆ¡ báº£n.

### ğŸ’¡ KhÃ¡i niá»‡m vÃ  lÃ½ thuyáº¿t
- **Optimistic Locking**: CÃ¡c ká»¹ thuáº­t Ä‘á»ƒ trÃ¡nh race conditions khi cáº­p nháº­t dá»¯ liá»‡u (sáº½ nghiÃªn cá»©u thÃªm).
- **Scalability for Counters**: Xem xÃ©t cÃ¡ch tá»‘i Æ°u hÃ³a viá»‡c Ä‘áº¿m sá»‘ lÆ°á»£ng ngÆ°á»i theo dÃµi cho cÃ¡c Page lá»›n.

### ğŸ¤ Soft Skills
- **Problem Solving**: Giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» liÃªn quan Ä‘áº¿n viá»‡c Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n dá»¯ liá»‡u khi follow/unfollow.
- **Efficient Development**: XÃ¢y dá»±ng tÃ­nh nÄƒng nhanh chÃ³ng dá»±a trÃªn kinh nghiá»‡m tá»« Page Member.

## ğŸš§ KhÃ³ khÄƒn vÃ  giáº£i phÃ¡p

### Váº¥n Ä‘á» 1: Äáº£m báº£o tÃ­nh nháº¥t quÃ¡n cá»§a sá»‘ lÆ°á»£ng ngÆ°á»i theo dÃµi (follower count)
- **MÃ´ táº£**: Náº¿u sá»‘ lÆ°á»£ng ngÆ°á»i theo dÃµi Ä‘Æ°á»£c lÆ°u trá»¯ nhÆ° má»™t cá»™t trong báº£ng `pages`, viá»‡c cáº­p nháº­t nÃ³ má»—i khi cÃ³ ngÆ°á»i follow/unfollow cÃ³ thá»ƒ gÃ¢y ra race conditions vÃ  dá»¯ liá»‡u khÃ´ng nháº¥t quÃ¡n.
- **áº¢nh hÆ°á»Ÿng**: Sá»‘ lÆ°á»£ng ngÆ°á»i theo dÃµi hiá»ƒn thá»‹ sai.
- **NguyÃªn nhÃ¢n gá»‘c rá»…**: Trá»±c tiáº¿p cáº­p nháº­t counter thay vÃ¬ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p an toÃ n.
- **CÃ¡ch giáº£i quyáº¿t Ä‘Ã£ Ã¡p dá»¥ng**: Quyáº¿t Ä‘á»‹nh khÃ´ng lÆ°u `follower_count` trá»±c tiáº¿p trong báº£ng `pages` á»Ÿ giai Ä‘oáº¡n nÃ y. Thay vÃ o Ä‘Ã³, sá»‘ lÆ°á»£ng ngÆ°á»i theo dÃµi sáº½ Ä‘Æ°á»£c tÃ­nh báº±ng cÃ¡ch Ä‘áº¿m sá»‘ báº£n ghi trong báº£ng `page_followers` má»—i khi yÃªu cáº§u. Äiá»u nÃ y Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n dá»¯ liá»‡u máº·c dÃ¹ cÃ³ thá»ƒ cháº­m hÆ¡n má»™t chÃºt cho cÃ¡c page cÃ³ quÃ¡ nhiá»u follower (sáº½ tá»‘i Æ°u báº±ng caching sau).
- **Káº¿t quáº£ sau khi giáº£i quyáº¿t**: Dá»¯ liá»‡u follower count luÃ´n chÃ­nh xÃ¡c, vá»›i kháº£ nÄƒng tá»‘i Æ°u hÃ³a sau nÃ y.
- **BÃ i há»c rÃºt ra**: LuÃ´n cÃ¢n nháº¯c trade-off giá»¯a tÃ­nh nháº¥t quÃ¡n dá»¯ liá»‡u vÃ  hiá»‡u suáº¥t, vÃ  báº¯t Ä‘áº§u vá»›i giáº£i phÃ¡p Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n trÆ°á»›c.

### Váº¥n Ä‘á» 2: NgÄƒn cháº·n viá»‡c follow/unfollow trÃ¹ng láº·p
- **MÃ´ táº£**: NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ vÃ´ tÃ¬nh gá»­i request follow má»™t Page nhiá»u láº§n, hoáº·c unfollow má»™t Page mÃ  há» chÆ°a follow.
- **áº¢nh hÆ°á»Ÿng**: GÃ¢y ra lá»—i hoáº·c dá»¯ liá»‡u khÃ´ng chÃ­nh xÃ¡c.
- **NguyÃªn nhÃ¢n gá»‘c rá»…**: Thiáº¿u kiá»ƒm tra Ä‘iá»u kiá»‡n trÆ°á»›c khi thá»±c hiá»‡n hÃ nh Ä‘á»™ng.
- **CÃ¡ch giáº£i quyáº¿t Ä‘Ã£ Ã¡p dá»¥ng**: Trong Service layer, trÆ°á»›c khi thá»±c hiá»‡n hÃ nh Ä‘á»™ng follow, kiá»ƒm tra xem ngÆ°á»i dÃ¹ng Ä‘Ã£ follow Page Ä‘Ã³ chÆ°a. TÆ°Æ¡ng tá»± cho unfollow. Tráº£ vá» response 409 Conflict hoáº·c 404 Not Found tÃ¹y trÆ°á»ng há»£p.
- **Káº¿t quáº£ sau khi giáº£i quyáº¿t**: API robust hÆ¡n, xá»­ lÃ½ Ä‘Ãºng cÃ¡c trÆ°á»ng há»£p ngÆ°á»i dÃ¹ng cá»‘ gáº¯ng thá»±c hiá»‡n hÃ nh Ä‘á»™ng trÃ¹ng láº·p.
- **BÃ i há»c rÃºt ra**: LuÃ´n kiá»ƒm tra cÃ¡c Ä‘iá»u kiá»‡n tiÃªn quyáº¿t trÆ°á»›c khi thá»±c hiá»‡n thay Ä‘á»•i dá»¯ liá»‡u trong API.

## ğŸ’­ Suy ngáº«m & Nháº­n thá»©c

### HÃ´m nay cÃ³ gÃ¬ diá»…n ra tá»‘t Ä‘áº¹p?
- TÃ­nh nÄƒng quáº£n lÃ½ Page Follower Ä‘Ã£ Ä‘Æ°á»£c triá»ƒn khai Ä‘áº§y Ä‘á»§.
- Page Service Ä‘Ã£ cÃ³ kháº£ nÄƒng quáº£n lÃ½ cÃ¡c má»‘i quan há»‡ ngÆ°á»i dÃ¹ng vá»›i Page (thÃ nh viÃªn, ngÆ°á»i theo dÃµi).
- Cáº£m tháº¥y tá»± tin vá»›i kháº£ nÄƒng cá»§a Page Service.

### Cáº§n cáº£i thiá»‡n Ä‘iá»u gÃ¬?
- Cáº§n thiáº¿t láº­p cÆ¡ cháº¿ phÃ¢n quyá»n quáº£n trá»‹ Ä‘á»ƒ Ä‘áº£m báº£o chá»‰ Member má»›i cÃ³ quyá»n Ä‘Äƒng táº£i sá»± kiá»‡n.
- Cáº§n review láº¡i táº¥t cáº£ cÃ¡c API cá»§a Page Service.

### ThÃ´ng tin chi tiáº¿t chÃ­nh
- XÃ¢y dá»±ng cÃ¡c tÃ­nh nÄƒng xÃ£ há»™i Ä‘Ã²i há»i sá»± chÃº Ã½ Ä‘áº¿n cáº£ thiáº¿t káº¿ database vÃ  logic nghiá»‡p vá»¥.
- Viá»‡c xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p cáº¡nh (edge cases) lÃ  ráº¥t quan trá»ng Ä‘á»ƒ Ä‘áº£m báº£o API hoáº¡t Ä‘á»™ng Ä‘Ãºng.

### CÃ¢u há»i & Tháº¯c máº¯c
- LÃ m tháº¿ nÃ o Ä‘á»ƒ implement caching hiá»‡u quáº£ cho `follower_count` Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t mÃ  váº«n Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n?
- CÃ³ best practices nÃ o cho viá»‡c gá»­i notifications Ä‘áº¿n ngÆ°á»i theo dÃµi khi cÃ³ sá»± kiá»‡n má»›i?

## ğŸ“‹ Káº¿ hoáº¡ch ngÃ y mai

### Nhiá»‡m vá»¥ Æ°u tiÃªn
- [ ] **High**: Implement cÆ¡ cháº¿ phÃ¢n quyá»n quáº£n trá»‹: chá»‰ Member má»›i cÃ³ quyá»n Ä‘Äƒng táº£i sá»± kiá»‡n.
- [ ] **Medium**: Review táº¥t cáº£ cÃ¡c API cá»§a Page Service, Ä‘áº£m báº£o security vÃ  consistency.
- [ ] **Low**: Chuáº©n bá»‹ bÃ¡o cÃ¡o tá»•ng káº¿t tuáº§n 5.

### Má»¥c tiÃªu há»c táº­p
- [ ] Äá»c tÃ i liá»‡u vá» Spring Security Authorization.
- [ ] TÃ¬m hiá»ƒu vá» cÃ¡c pattern thiáº¿t káº¿ phÃ¢n quyá»n trong Microservices.

### CÃ¡c cuá»™c há»p vÃ  thá»i háº¡n
- KhÃ´ng cÃ³ cuá»™c há»p cá»‘ Ä‘á»‹nh.

## ğŸ“Š Tá»± Ä‘Ã¡nh giÃ¡

### NÄƒng suáº¥t
- **Äiá»ƒm**: 9/10
- **LÃ½ do**: HoÃ n thÃ nh xuáº¥t sáº¯c viá»‡c triá»ƒn khai API quáº£n lÃ½ ngÆ°á»i theo dÃµi.
- **CÃ¡ch cáº£i thiá»‡n**: CÃ³ thá»ƒ dÃ nh thÃªm thá»i gian nghiÃªn cá»©u vá» tá»‘i Æ°u hÃ³a truy váº¥n cho follower count.

### Há»c há»i
- **Äiá»ƒm**: 9/10
- **LÃ½ do**: Há»c Ä‘Æ°á»£c nhiá»u vá» thiáº¿t káº¿ API cho cÃ¡c tÃ­nh nÄƒng xÃ£ há»™i vÃ  xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p cáº¡nh.
- **CÃ¡ch cáº£i thiá»‡n**: NghiÃªn cá»©u sÃ¢u hÆ¡n vá» cÃ¡c chiáº¿n lÆ°á»£c caching vÃ  tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t database.

### Há»£p tÃ¡c
- **Äiá»ƒm**: 8.5/10
- **LÃ½ do**: ÄÃ£ chia sáº» API má»›i vá»›i Frontend team.
- **CÃ¡ch cáº£i thiá»‡n**: Chá»§ Ä‘á»™ng há»i feedback tá»« Frontend team vá» tÃ­nh dá»… sá»­ dá»¥ng cá»§a API.

### Má»©c Ä‘á»™ hÃ i lÃ²ng tá»•ng thá»ƒ
- **Äiá»ƒm**: 9/10
- **LÃ½ do**: Ráº¥t hÃ i lÃ²ng khi Page Service Ä‘Ã£ cÃ³ kháº£ nÄƒng quáº£n lÃ½ ngÆ°á»i theo dÃµi.
- **CÃ¡ch cáº£i thiá»‡n**: Duy trÃ¬ sá»± táº­p trung Ä‘á»ƒ hoÃ n thiá»‡n tÃ­nh nÄƒng phÃ¢n quyá»n.

## ğŸ“ Tá»‡p Ä‘Ã­nh kÃ¨m & Link liÃªn káº¿t

### TÃ i nguyÃªn há»c táº­p
- [Spring Data JPA - Custom Queries](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods)
- [REST API Design for Social Features](https://developer.mozilla.org/en-US/docs/Glossary/REST)

### TÃ i liá»‡u há»c táº­p
- [BÃ i viáº¿t vá» Race Conditions in Database](https://medium.com/@adnan.gharaibeh/handling-race-conditions-in-database-operations-e60d09c6d36e)

---

**ğŸ“ Ghi chÃº quan trá»ng cho ngÃ y mai:**
Táº­p trung vÃ o tÃ­nh nÄƒng phÃ¢n quyá»n quáº£n trá»‹ vÃ  tá»•ng káº¿t tuáº§n 5.

**ğŸ¯ Tiáº¿n Ä‘á»™ so vá»›i má»¥c tiÃªu tuáº§n:**
**90%** (Page Service CRUD for Pages, Members, Followers implemented)

---
_Worklog created by: LÆ° Hiáº¿u Trung_
_Next review: 30/11/2025_