# Worklog - NgÃ y 24/12/2025

## ğŸ“… ThÃ´ng tin cÆ¡ báº£n
- **NgÃ y**: 24/12/2025
- **Thá»©**: Thá»© TÆ°
- **Tuáº§n thá»±c táº­p**: 9/8
- **Thá»i gian lÃ m viá»‡c**: 18:00 - 22:00
- **Mood**: ğŸ’ª Cáº£m tháº¥y hiá»‡u quáº£ sau khi vÆ°á»£t qua nhiá»u thÃ¡ch thá»©c ká»¹ thuáº­t.

## ğŸ¯ Má»¥c tiÃªu ngÃ y hÃ´m nay
- [x] Triá»ƒn khai Page Service lÃªn AWS ECS Service, tÃ­ch há»£p AWS Secrets Manager cho database credentials.
- [x] Triá»ƒn khai AIChat Service lÃªn AWS ECS (táº¡o Task Definition, Service).
- [x] Cáº¥u hÃ¬nh AWS RDS (PostgreSQL) cho cáº£ Page Service vÃ  AIChat Service.
- [x] CÃ i Ä‘áº·t S3 Storage Ä‘á»ƒ lÆ°u trá»¯ tÃ i nguyÃªn hÃ¬nh áº£nh cho Page vÃ  Event.

## ğŸ’¼ CÃ´ng viá»‡c Ä‘Ã£ thá»±c hiá»‡n

### 1. Triá»ƒn khai Page Service lÃªn ECS vÃ  tÃ­ch há»£p Secrets Manager â±ï¸ 1.5 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ táº¡o ECS Service cho Page Service dá»±a trÃªn Task Definition Ä‘Ã£ cÃ³. TrÆ°á»›c Ä‘Ã³, Ä‘Ã£ táº¡o má»™t secret trong AWS Secrets Manager Ä‘á»ƒ lÆ°u trá»¯ database credentials (`db_page_service_credentials`). Sau Ä‘Ã³, cáº­p nháº­t Task Definition Ä‘á»ƒ tham chiáº¿u secret nÃ y thay vÃ¬ sá»­ dá»¥ng biáº¿n mÃ´i trÆ°á»ng trá»±c tiáº¿p. ÄÃ£ táº¡o má»™t IAM Role cho ECS Task Ä‘á»ƒ cÃ³ quyá»n truy cáº­p secret nÃ y.
- **Káº¿t quáº£**: Page Service Ä‘Ã£ hoáº¡t Ä‘á»™ng trÃªn ECS, cÃ³ thá»ƒ káº¿t ná»‘i an toÃ n vá»›i database (sáº½ cáº¥u hÃ¬nh RDS á»Ÿ bÆ°á»›c sau) báº±ng cÃ¡ch láº¥y credentials tá»« Secrets Manager.
- **Tools/Tech**: AWS ECS Console, AWS Secrets Manager, IAM Roles.
- **Links**: [Screenshot ECS Service Page Service (Cáº§n thÃªm áº£nh/link)], [Screenshot Secrets Manager config (Cáº§n thÃªm áº£nh/link)]

### 2. Triá»ƒn khai AIChat Service lÃªn AWS ECS â±ï¸ 1 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ táº¡o má»™t Task Definition má»›i (`ai-chat-service-task-definition`) vÃ  má»™t ECS Service cho AIChat Service, tÆ°Æ¡ng tá»± nhÆ° Page Service. ÄÃ£ cáº¥u hÃ¬nh Docker image, phÃ¢n bá»• tÃ i nguyÃªn vÃ  port mapping. ÄÃ£ thÃªm cÃ¡c biáº¿n mÃ´i trÆ°á»ng cáº§n thiáº¿t cho AIChat Service, Ä‘áº·c biá»‡t lÃ  `GOOGLE_AI_STUDIO_API_KEY` (táº¡m thá»i, sau sáº½ dÃ¹ng Secrets Manager).
- **Káº¿t quáº£**: AIChat Service Ä‘Ã£ Ä‘Æ°á»£c deploy lÃªn ECS, sáºµn sÃ ng cho viá»‡c kiá»ƒm thá»­ káº¿t ná»‘i vá»›i cÃ¡c dá»‹ch vá»¥ AI bÃªn ngoÃ i.
- **Tools/Tech**: AWS ECS Console, Docker, Spring Boot.
- **Links**: [Screenshot ECS Service AIChat Service (Cáº§n thÃªm áº£nh/link)]

### 3. Cáº¥u hÃ¬nh AWS RDS (PostgreSQL) â±ï¸ 1 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ táº¡o hai instance RDS PostgreSQL riÃªng biá»‡t (`db-page-service` vÃ  `db-ai-chat-service`) cho Page Service vÃ  AIChat Service, tuÃ¢n thá»§ kiáº¿n trÃºc Database-per-Service. ÄÃ£ Ä‘áº·t chÃºng trong private subnets Ä‘á»ƒ tÄƒng cÆ°á»ng báº£o máº­t vÃ  cáº¥u hÃ¬nh Security Groups Ä‘á»ƒ chá»‰ cho phÃ©p traffic tá»« ECS Tasks cá»§a tá»«ng service. ÄÃ£ Ä‘áº£m báº£o Subnet Group vÃ  Parameter Group Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘Ãºng.
- **Káº¿t quáº£**: Hai database PostgreSQL Ä‘Ã£ sáºµn sÃ ng vÃ  an toÃ n cho cÃ¡c Microservices Backend.
- **Tools/Tech**: AWS RDS Console, PostgreSQL, Security Groups.
- **Links**: [Screenshot RDS Instance config (Cáº§n thÃªm áº£nh/link)], [Screenshot RDS Security Group (Cáº§n thÃªm áº£nh/link)]

### 4. CÃ i Ä‘áº·t S3 Storage cho tÃ i nguyÃªn hÃ¬nh áº£nh â±ï¸ 0.5 tiáº¿ng
- **MÃ´ táº£**: ÄÃ£ táº¡o má»™t S3 bucket má»›i (`my-event-platform-assets`) Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c tÃ i nguyÃªn tÄ©nh nhÆ° hÃ¬nh áº£nh sá»± kiá»‡n, banner trang, v.v. ÄÃ£ cáº¥u hÃ¬nh bucket policy cho phÃ©p cÃ¡c ECS Tasks upload vÃ  download file.
- **Káº¿t quáº£**: S3 bucket cho assets Ä‘Ã£ sáºµn sÃ ng, cung cáº¥p giáº£i phÃ¡p lÆ°u trá»¯ cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng vÃ  Ä‘Ã¡ng tin cáº­y.
- **Tools/Tech**: AWS S3 Console.
- **Links**: [Screenshot S3 Assets bucket (Cáº§n thÃªm áº£nh/link)]

## ğŸ“š Kiáº¿n thá»©c há»c Ä‘Æ°á»£c

### ğŸ”§ Ká»¹ nÄƒng ká»¹ thuáº­t
- **AWS Services**: ECS Service, Secrets Manager, RDS (PostgreSQL), S3.
- **Containerization**: Deploying multiple services with ECS.
- **Security**: Quáº£n lÃ½ database credentials an toÃ n vá»›i Secrets Manager.
- **Database**: Cáº¥u hÃ¬nh RDS instances.

### ğŸ’¡ KhÃ¡i niá»‡m vÃ  lÃ½ thuyáº¿t
- **Database-per-Service**: Hiá»ƒu lá»£i Ã­ch cá»§a viá»‡c tÃ¡ch database cho má»—i Microservice.
- **Secrets Management**: Táº§m quan trá»ng cá»§a viá»‡c khÃ´ng hardcode secrets vÃ  sá»­ dá»¥ng dá»‹ch vá»¥ quáº£n lÃ½ secrets.
- **Secure by Design**: Cáº¥u hÃ¬nh máº¡ng vÃ  quyá»n truy cáº­p Ä‘á»ƒ Ä‘áº£m báº£o há»‡ thá»‘ng an toÃ n ngay tá»« Ä‘áº§u.

### ğŸ¤ Soft Skills
- **Problem Solving**: VÆ°á»£t qua cÃ¡c thÃ¡ch thá»©c vá» káº¿t ná»‘i máº¡ng vÃ  quyá»n truy cáº­p RDS.
- **Attention to Detail**: Cáº¥u hÃ¬nh chÃ­nh xÃ¡c cÃ¡c Security Group vÃ  Subnet Group Ä‘á»ƒ Ä‘áº£m báº£o káº¿t ná»‘i.

## ğŸš§ KhÃ³ khÄƒn vÃ  giáº£i phÃ¡p

### Váº¥n Ä‘á» 1: Káº¿t ná»‘i RDS bá»‹ lá»—i tá»« ECS Tasks
- **MÃ´ táº£**: Sau khi triá»ƒn khai Page Service vÃ  táº¡o RDS instance, ECS Task khÃ´ng thá»ƒ káº¿t ná»‘i tá»›i database. Log hiá»ƒn thá»‹ lá»—i timeout hoáº·c connection refused.
- **áº¢nh hÆ°á»Ÿng**: Backend Service khÃ´ng hoáº¡t Ä‘á»™ng, ngÄƒn cháº·n Frontend giao tiáº¿p vá»›i dá»¯ liá»‡u.
- **NguyÃªn nhÃ¢n gá»‘c rá»…**: Cáº¥u hÃ¬nh Security Group cá»§a RDS khÃ´ng cho phÃ©p inbound traffic tá»« Security Group cá»§a ECS Tasks. Hoáº·c RDS Subnet Group khÃ´ng chá»©a Ä‘á»§ cÃ¡c Subnet mÃ  ECS Task Ä‘Æ°á»£c triá»ƒn khai.
- **CÃ¡ch giáº£i quyáº¿t Ä‘Ã£ Ã¡p dá»¥ng**: ÄÃ£ kiá»ƒm tra ká»¹ láº¡i cáº¥u hÃ¬nh Security Group cá»§a RDS, thÃªm inbound rule cho phÃ©p traffic tá»« Security Group cá»§a ECS Tasks trÃªn port PostgreSQL (5432). Äáº£m báº£o ráº±ng RDS Subnet Group bao gá»“m táº¥t cáº£ cÃ¡c private subnets mÃ  ECS Tasks cÃ³ thá»ƒ Ä‘Æ°á»£c khá»Ÿi cháº¡y.
- **Káº¿t quáº£ sau khi giáº£i quyáº¿t**: ECS Task cÃ³ thá»ƒ káº¿t ná»‘i thÃ nh cÃ´ng vá»›i RDS.
- **BÃ i há»c rÃºt ra**: Máº¡ng vÃ  Security Groups lÃ  yáº¿u tá»‘ quan trá»ng nháº¥t cáº§n kiá»ƒm tra ká»¹ khi káº¿t ná»‘i giá»¯a cÃ¡c dá»‹ch vá»¥ AWS.

### Váº¥n Ä‘á» 2: AIChat Service khÃ´ng truy cáº­p Ä‘Æ°á»£c Google AI Studio
- **MÃ´ táº£**: AIChat Service Ä‘Æ°á»£c deploy lÃªn ECS nhÆ°ng khÃ´ng thá»ƒ thá»±c hiá»‡n cÃ¡c request ra ngoÃ i tá»›i Google AI Studio API, dáº«n Ä‘áº¿n lá»—i timeout.
- **áº¢nh hÆ°á»Ÿng**: Chá»©c nÄƒng AI Chatbot khÃ´ng hoáº¡t Ä‘á»™ng.
- **NguyÃªn nhÃ¢n gá»‘c rá»…**: ECS Task Ä‘Æ°á»£c Ä‘áº·t trong private subnets vÃ  thiáº¿u outbound route qua NAT Gateway. Hoáº·c Security Group cá»§a Task khÃ´ng cho phÃ©p outbound traffic tá»›i cÃ¡c cá»•ng cáº§n thiáº¿t (443 HTTPS).
- **CÃ¡ch giáº£i quyáº¿t Ä‘Ã£ Ã¡p dá»¥ng**: ÄÃ£ kiá»ƒm tra Route Table cá»§a private subnets Ä‘á»ƒ Ä‘áº£m báº£o cÃ³ route tá»›i NAT Gateway. Cáº¥u hÃ¬nh Security Group cá»§a AIChat Service Task Ä‘á»ƒ cho phÃ©p outbound traffic Ä‘áº¿n má»i nÆ¡i trÃªn port 443 (HTTPS) Ä‘á»ƒ truy cáº­p cÃ¡c dá»‹ch vá»¥ bÃªn ngoÃ i.
- **Káº¿t quáº£ sau khi giáº£i quyáº¿t**: AIChat Service cÃ³ thá»ƒ gá»i thÃ nh cÃ´ng Google AI Studio API.
- **BÃ i há»c rÃºt ra**: LuÃ´n Ä‘áº£m báº£o outbound connectivity cho cÃ¡c private subnets thÃ´ng qua NAT Gateway náº¿u service cáº§n truy cáº­p internet, vÃ  cáº¥u hÃ¬nh Security Group cho phÃ©p outbound traffic cáº§n thiáº¿t.

## ğŸ’­ Suy ngáº«m & Nháº­n thá»©c

### HÃ´m nay cÃ³ gÃ¬ diá»…n ra tá»‘t Ä‘áº¹p?
- Cáº£ Page Service vÃ  AIChat Service Ä‘Ã£ Ä‘Æ°á»£c triá»ƒn khai thÃ nh cÃ´ng lÃªn ECS.
- RDS instances Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh an toÃ n cho má»—i service.
- ÄÃ£ giáº£i quyáº¿t Ä‘Æ°á»£c hai váº¥n Ä‘á» máº¡ng vÃ  káº¿t ná»‘i phá»©c táº¡p, mang láº¡i cáº£m giÃ¡c chinh phá»¥c.

### Cáº§n cáº£i thiá»‡n Ä‘iá»u gÃ¬?
- Cáº§n cáº¥u hÃ¬nh Application Load Balancer Ä‘á»ƒ Ä‘á»‹nh tuyáº¿n traffic Ä‘áº¿n cÃ¡c ECS Services vÃ  quáº£n lÃ½ HTTPS.
- Cáº§n tá»± Ä‘á»™ng hÃ³a viá»‡c Ä‘áº©y Docker images lÃªn ECR thÃ´ng qua GitHub Actions.

### ThÃ´ng tin chi tiáº¿t chÃ­nh
- ECS, RDS, S3 lÃ  bá»™ ba cá»‘t lÃµi cho cÃ¡c á»©ng dá»¥ng backend hiá»‡n Ä‘áº¡i trÃªn AWS.
- Quáº£n lÃ½ secrets vá»›i Secrets Manager lÃ  khÃ´ng thá»ƒ thiáº¿u cho báº£o máº­t Cloud.

### CÃ¢u há»i & Tháº¯c máº¯c
- LÃ m tháº¿ nÃ o Ä‘á»ƒ cáº¥u hÃ¬nh auto-scaling cho ECS Service dá»±a trÃªn CPU/Memory utilization hoáº·c cÃ¡c metrics tÃ¹y chá»‰nh?
- CÃ³ cÃ¡ch nÃ o Ä‘á»ƒ giÃ¡m sÃ¡t cÃ¡c lá»—i káº¿t ná»‘i Kafka cá»§a Backend Services trÃªn AWS khÃ´ng?

## ğŸ“‹ Káº¿ hoáº¡ch ngÃ y mai

### Nhiá»‡m vá»¥ Æ°u tiÃªn
- [ ] **High**: Báº¯t Ä‘áº§u xÃ¢y dá»±ng CloudFormation templates Ä‘á»ƒ Ä‘Ã³ng gÃ³i toÃ n bá»™ háº¡ táº§ng Ä‘Ã£ triá»ƒn khai (ECS, RDS, S3, ALB, Security Groups, IAM Roles).
- [ ] **Medium**: Cáº¥u hÃ¬nh Application Load Balancer (ALB) vÃ  Target Groups cho Page Service vÃ  AIChat Service.
- [ ] **Low**: Thiáº¿t láº­p auto-scaling cho cÃ¡c ECS Services.

### Má»¥c tiÃªu há»c táº­p
- [ ] Äá»c tÃ i liá»‡u vá» AWS CloudFormation vÃ  cÃ¡ch táº¡o templates cho Microservices.
- [ ] TÃ¬m hiá»ƒu vá» ALB Listeners, Target Groups vÃ  Routing Rules.

### CÃ¡c cuá»™c há»p vÃ  thá»i háº¡n
- KhÃ´ng cÃ³ cuá»™c há»p cá»‘ Ä‘á»‹nh.

## ğŸ“Š Tá»± Ä‘Ã¡nh giÃ¡

### NÄƒng suáº¥t
- **Äiá»ƒm**: 9.5/10
- **LÃ½ do**: ÄÃ£ hoÃ n thÃ nh ráº¥t nhiá»u má»¥c tiÃªu phá»©c táº¡p, vÆ°á»£t qua cÃ¡c thÃ¡ch thá»©c ká»¹ thuáº­t lá»›n vá» máº¡ng vÃ  báº£o máº­t.
- **CÃ¡ch cáº£i thiá»‡n**: CÃ³ thá»ƒ dÃ nh thÃªm thá»i gian cho viá»‡c logging vÃ  monitoring ngay sau khi deploy.

### Há»c há»i
- **Äiá»ƒm**: 9.5/10
- **LÃ½ do**: Há»c Ä‘Æ°á»£c ráº¥t nhiá»u tá»« viá»‡c debug vÃ  giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» thá»±c táº¿ khi triá»ƒn khai Backend trÃªn AWS.
- **CÃ¡ch cáº£i thiá»‡n**: Cáº§n tiáº¿p tá»¥c Ä‘Ã o sÃ¢u vá» cÃ¡c dá»‹ch vá»¥ AWS Ä‘á»ƒ tá»‘i Æ°u hÃ³a kiáº¿n trÃºc.

### Há»£p tÃ¡c
- **Äiá»ƒm**: 8.5/10
- **LÃ½ do**: ÄÃ£ chia sáº» kinh nghiá»‡m vá» cÃ¡c váº¥n Ä‘á» máº¡ng vá»›i nhÃ³m Ä‘á»ƒ cÃ¡c thÃ nh viÃªn khÃ¡c cÃ³ thá»ƒ há»c há»i.
- **CÃ¡ch cáº£i thiá»‡n**: Chá»§ Ä‘á»™ng hÆ¡n trong viá»‡c review vÃ  há»— trá»£ cÃ¡c thÃ nh viÃªn khÃ¡c.

### Má»©c Ä‘á»™ hÃ i lÃ²ng tá»•ng thá»ƒ
- **Äiá»ƒm**: 9.5/10
- **LÃ½ do**: Ráº¥t hÃ i lÃ²ng vá»›i viá»‡c Backend Ä‘Ã£ lÃªn Cloud vÃ  hoáº¡t Ä‘á»™ng tÆ°Æ¡ng Ä‘á»‘i á»•n Ä‘á»‹nh.
- **CÃ¡ch cáº£i thiá»‡n**: Tiáº¿p tá»¥c duy trÃ¬ Ä‘Ã  phÃ¡t triá»ƒn vÃ  sá»± tá»± tin.

## ğŸ“ Tá»‡p Ä‘Ã­nh kÃ¨m & Link liÃªn káº¿t

### TÃ i nguyÃªn há»c táº­p
- [TÃ i liá»‡u AWS ECS Service](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html)
- [TÃ i liá»‡u AWS Secrets Manager with ECS](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/secrets-ami.html)
- [TÃ i liá»‡u AWS RDS PostgreSQL](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_PostgreSQL.html)

#### - Danh sÃ¡ch cÃ¡c video Ä‘Ã£ xem:
    - Video hÆ°á»›ng dáº«n triá»ƒn khai Spring Boot Microservices lÃªn ECS.
    - Video vá» cÃ¡ch báº£o máº­t credentials trÃªn AWS.

### TÃ i liá»‡u há»c táº­p
- [BÃ i viáº¿t vá» kiáº¿n trÃºc Database-per-Service](https://microservices.io/patterns/data/database-per-service.html)

---

**ğŸ“ Ghi chÃº quan trá»ng cho ngÃ y mai:**
Chuyá»ƒn sang Infrastructure as Code vá»›i CloudFormation Ä‘á»ƒ Ä‘Ã³ng gÃ³i toÃ n bá»™ háº¡ táº§ng vÃ  cáº¥u hÃ¬nh ALB.

**ğŸ¯ Tiáº¿n Ä‘á»™ so vá»›i má»¥c tiÃªu tuáº§n:**
**75%** (Frontend deployed, Backend deployed (ECS, RDS, S3))

---
_Worklog created by: LÆ° Hiáº¿u Trung_  
_Next review: 25/12/2025_